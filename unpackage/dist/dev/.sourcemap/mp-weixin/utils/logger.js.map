{"version":3,"file":"logger.js","sources":["utils/logger.js"],"sourcesContent":["\r\nimport appUtil from './app-util.js';\nconst writeToLogFile = true;\nfunction e(tag, msg) {\n    if (msg) {\n        console.log(tag, msg);\n    } else {\n        console.log(tag);\n    }\n    if (writeToLogFile) {\n        if (msg) {\n            writeLogFile(getDataString(tag + ' ' + msg));\n        } else {\n            writeLogFile(getDataString(tag));\n        }\n    }\n}\nfunction clear() {\n    uni.setStorage({\n        key: 'log',\n        data: ''\n    });\n}\nfunction getDataString(msg) {\n    var d = new Date();\n    var formatData = 'MM-dd HH:mm:ss SSS ' + msg + '\\n';\n    var data = formatData\n        .replace('yyyy', d.getFullYear())\n        .replace('MM', fillZero(d.getMonth() + 1))\n        .replace('dd', fillZero(d.getDate()))\n        .replace('HH', fillZero(d.getHours()))\n        .replace('mm', fillZero(d.getMinutes()))\n        .replace('ss', fillZero(d.getSeconds()))\n        .replace('SSS', d.getMilliseconds());\n    return data;\n}\nfunction getDateString(timestamp) {\n    var d = new Date(timestamp);\n    var formatData = 'yyyy-MM-dd HH:mm:ss';\n    var data = formatData\n        .replace('yyyy', d.getFullYear())\n        .replace('MM', fillZero(d.getMonth() + 1))\n        .replace('dd', fillZero(d.getDate()))\n        .replace('HH', fillZero(d.getHours()))\n        .replace('mm', fillZero(d.getMinutes()))\n        .replace('ss', fillZero(d.getSeconds()))\n        .replace('SSS', d.getMilliseconds());\n    return data;\n}\n\n//填充0\nfunction fillZero(value) {\n    if (value.toString().length < 2) {\n        return '0' + value;\n    }\n    return value;\n}\nfunction writeLogFile(msg) {\n    try {\n        var value = uni.getStorageSync('log');\n        if (value) {\n            try {\n                var data = value + msg;\n                var length = data.length;\n                if (length > 5120) {\n                    uni.setStorageSync('log', data.substring(4096));\n                } else {\n                    uni.setStorageSync('log', data);\n                }\n            } catch (e) {\n                console.log('CatchClause', e);\n                console.log('CatchClause', e);\n            }\n        } else {\n            try {\n                uni.setStorageSync('log', msg);\n            } catch (e) {\n                console.log('CatchClause', e);\n                console.log('CatchClause', e);\n            }\n        }\n    } catch (e) {\n        console.log('CatchClause', e);\n        console.log('CatchClause', e);\n    }\n}\nexport default {\n    e: e,\n    clear: clear,\n    getDateString: getDateString\n};\n"],"names":["uni","e"],"mappings":";;AAGA,SAAS,EAAE,KAAK,KAAK;AACjB,MAAI,KAAK;AACLA,kBAAA,MAAA,MAAA,OAAA,wBAAY,KAAK,GAAG;AAAA,EAC5B,OAAW;AACHA,kBAAAA,MAAA,MAAA,OAAA,wBAAY,GAAG;AAAA,EAClB;AACmB;AAChB,QAAI,KAAK;AACL,mBAAa,cAAc,MAAM,MAAM,GAAG,CAAC;AAAA,IACvD,OAAe;AACH,mBAAa,cAAc,GAAG,CAAC;AAAA,IAClC;AAAA,EACJ;AACL;AACA,SAAS,QAAQ;AACbA,gBAAAA,MAAI,WAAW;AAAA,IACX,KAAK;AAAA,IACL,MAAM;AAAA,EACd,CAAK;AACL;AACA,SAAS,cAAc,KAAK;AACxB,MAAI,IAAI,oBAAI;AACZ,MAAI,aAAa,wBAAwB,MAAM;AAC/C,MAAI,OAAO,WACN,QAAQ,QAAQ,EAAE,aAAa,EAC/B,QAAQ,MAAM,SAAS,EAAE,SAAQ,IAAK,CAAC,CAAC,EACxC,QAAQ,MAAM,SAAS,EAAE,QAAS,CAAA,CAAC,EACnC,QAAQ,MAAM,SAAS,EAAE,SAAU,CAAA,CAAC,EACpC,QAAQ,MAAM,SAAS,EAAE,WAAY,CAAA,CAAC,EACtC,QAAQ,MAAM,SAAS,EAAE,WAAY,CAAA,CAAC,EACtC,QAAQ,OAAO,EAAE,gBAAiB,CAAA;AACvC,SAAO;AACX;AACA,SAAS,cAAc,WAAW;AAC9B,MAAI,IAAI,IAAI,KAAK,SAAS;AAC1B,MAAI,aAAa;AACjB,MAAI,OAAO,WACN,QAAQ,QAAQ,EAAE,aAAa,EAC/B,QAAQ,MAAM,SAAS,EAAE,SAAQ,IAAK,CAAC,CAAC,EACxC,QAAQ,MAAM,SAAS,EAAE,QAAS,CAAA,CAAC,EACnC,QAAQ,MAAM,SAAS,EAAE,SAAU,CAAA,CAAC,EACpC,QAAQ,MAAM,SAAS,EAAE,WAAY,CAAA,CAAC,EACtC,QAAQ,MAAM,SAAS,EAAE,WAAY,CAAA,CAAC,EACtC,QAAQ,OAAO,EAAE,gBAAiB,CAAA;AACvC,SAAO;AACX;AAGA,SAAS,SAAS,OAAO;AACrB,MAAI,MAAM,WAAW,SAAS,GAAG;AAC7B,WAAO,MAAM;AAAA,EAChB;AACD,SAAO;AACX;AACA,SAAS,aAAa,KAAK;AACvB,MAAI;AACA,QAAI,QAAQA,cAAAA,MAAI,eAAe,KAAK;AACpC,QAAI,OAAO;AACP,UAAI;AACA,YAAI,OAAO,QAAQ;AACnB,YAAI,SAAS,KAAK;AAClB,YAAI,SAAS,MAAM;AACfA,wBAAG,MAAC,eAAe,OAAO,KAAK,UAAU,IAAI,CAAC;AAAA,QAClE,OAAuB;AACHA,wBAAAA,MAAI,eAAe,OAAO,IAAI;AAAA,QACjC;AAAA,MACJ,SAAQC,IAAG;AACRD,sBAAA,MAAA,MAAA,OAAA,yBAAY,eAAeC,EAAC;AAC5BD,sBAAA,MAAA,MAAA,OAAA,yBAAY,eAAeC,EAAC;AAAA,MAC/B;AAAA,IACb,OAAe;AACH,UAAI;AACAD,sBAAAA,MAAI,eAAe,OAAO,GAAG;AAAA,MAChC,SAAQC,IAAG;AACRD,sBAAA,MAAA,MAAA,OAAA,yBAAY,eAAeC,EAAC;AAC5BD,sBAAA,MAAA,MAAA,OAAA,yBAAY,eAAeC,EAAC;AAAA,MAC/B;AAAA,IACJ;AAAA,EACJ,SAAQA,IAAG;AACRD,kBAAA,MAAA,MAAA,OAAA,yBAAY,eAAeC,EAAC;AAC5BD,kBAAA,MAAA,MAAA,OAAA,yBAAY,eAAeC,EAAC;AAAA,EAC/B;AACL;AACA,MAAe,SAAA;AAAA,EACX;AAAA,EACA;AAAA,EACA;AACJ;;"}